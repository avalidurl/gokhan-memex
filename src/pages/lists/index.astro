---
import { getCollection } from 'astro:content'
import BaseLayout from '@/layouts/BaseLayout.astro'

// Import lists data
import listsData from '@/data/lists.json'

// Get all published blog posts for music and books categories
const allPosts = (await getCollection('blog'))
  .filter(post => !post.data.draft)
  .sort((a, b) => new Date(b.data.publishDate).valueOf() - new Date(a.data.publishDate).valueOf())

const musicPosts = allPosts.filter(post => post.data.category === 'Music')
const bookPosts = allPosts.filter(post => 
  post.data.category === 'Books' || 
  (post.data.tags && post.data.tags.includes('books'))
)

const people = listsData.people
---

<BaseLayout
  title="Lists"
  description="Curated collection of thought leaders, researchers, and writers shaping AI, rationality, fintech, and deep tech."
>
  <div class="mx-auto max-w-2xl px-6 py-12 lg:py-16">
    <!-- Header -->
    <header class="mb-12">
      <h1 class="text-3xl font-semibold tracking-tight mb-4">Lists</h1>
      <p class="text-muted-foreground">
        Curated recommendations of people, publications, and content I follow.
      </p>
    </header>

    <div class="space-y-12">
      <!-- Blogroll Section -->
      <section id="blogroll">
        <h2 class="text-sm font-medium uppercase tracking-wider text-muted-foreground mb-4">
          Blogroll
        </h2>
        <p class="text-sm text-muted-foreground mb-6">
          Thinkers and writers on AI, rationality, economics, and technology.
        </p>
        <ul class="space-y-3">
          {people.map(person => (
            <li>
              <a 
                href={person.url}
                target={person.url.startsWith('/') ? '_self' : '_blank'}
                rel={person.url.startsWith('/') ? '' : 'noopener'}
                class="group block"
              >
                <span class="text-foreground group-hover:underline decoration-1 underline-offset-2">
                  {person.name}
                </span>
                {!person.url.startsWith('/') && (
                  <span class="text-muted-foreground text-sm ml-1">â†—</span>
                )}
                <span class="block text-sm text-muted-foreground mt-0.5">
                  {person.description}
                </span>
              </a>
            </li>
          ))}
        </ul>
      </section>

      <!-- Books Section -->
      {bookPosts.length > 0 && (
        <section id="books">
          <h2 class="text-sm font-medium uppercase tracking-wider text-muted-foreground mb-4">
            Books
          </h2>
          <p class="text-sm text-muted-foreground mb-6">
            Book reviews and reading reflections.
          </p>
          <ul class="space-y-2">
            {bookPosts.map(post => (
              <li>
                <a 
                  href={`/journal/${post.slug}/`}
                  class="group flex items-baseline gap-3 py-1"
                >
                  <span class="text-foreground group-hover:underline decoration-1 underline-offset-2">
                    {post.data.title}
                  </span>
                  <span class="text-sm text-muted-foreground shrink-0">
                    {post.data.publishDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}
                  </span>
                </a>
              </li>
            ))}
          </ul>
        </section>
      )}

      <!-- Music Section -->
      {musicPosts.length > 0 && (
        <section id="music">
          <h2 class="text-sm font-medium uppercase tracking-wider text-muted-foreground mb-4">
            Music
          </h2>
          <p class="text-sm text-muted-foreground mb-6">
            Sound art, playlists, and musical explorations.
          </p>
          <ul class="space-y-2">
            {musicPosts.map(post => (
              <li>
                <a 
                  href={`/journal/${post.slug}/`}
                  class="group flex items-baseline gap-3 py-1"
                >
                  <span class="text-foreground group-hover:underline decoration-1 underline-offset-2">
                    {post.data.title}
                  </span>
                  <span class="text-sm text-muted-foreground shrink-0">
                    {post.data.publishDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}
                  </span>
                </a>
              </li>
            ))}
          </ul>
        </section>
      )}
    </div>
  </div>
</BaseLayout>
