---
interface Props {
  url: string
  title?: string
  author?: string
  description?: string
}

const { url, title, author, description } = Astro.props

// Extract basic info from Mirror URL
function parseMirrorUrl(url: string) {
  try {
    const urlObj = new URL(url)
    if (urlObj.hostname.includes('mirror.xyz')) {
      return { 
        platform: 'Mirror',
        displayUrl: url,
        isMirror: true
      }
    }
    return { 
      platform: 'Article',
      displayUrl: url,
      isMirror: false
    }
  } catch {
    return { 
      platform: 'Article',
      displayUrl: url,
      isMirror: false
    }
  }
}

const mirrorInfo = parseMirrorUrl(url)
---

<div class="my-6 not-prose">
  <div class="rounded-lg border bg-card p-6">
    <div class="space-y-4">
      <!-- Header -->
      <div class="flex items-center justify-between">
        {title ? (
          <h3 class="text-lg font-semibold">{title}</h3>
        ) : (
          <h3 class="text-lg font-semibold">Article on {mirrorInfo.platform}</h3>
        )}
        <div class="text-xs text-muted-foreground bg-muted px-2 py-1 rounded">
          {mirrorInfo.platform}
        </div>
      </div>

      <!-- Author -->
      {author && (
        <p class="text-sm font-medium text-foreground">by {author}</p>
      )}

      <!-- Description -->
      {description && (
        <p class="text-sm text-muted-foreground">{description}</p>
      )}

      <!-- Actions -->
      <div class="flex gap-3">
        <a
          href={url}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium"
        >
          Read Article â†’
        </a>
        {mirrorInfo.isMirror && (
          <a
            href={url}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center px-4 py-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground rounded-md transition-colors text-sm"
          >
            Open in Mirror
          </a>
        )}
      </div>
    </div>
  </div>
</div>