---
import { Rss, Menu, X, Search } from 'lucide-astro'
import Button from './ui/Button.astro'
import ThemeToggle from './ThemeToggle.astro'
import SearchComponent from './Search.astro'

const currentPath = Astro.url.pathname
const navigation = [
  { name: 'Journal', href: '/journal' },
  { name: 'Archive', href: '/archive' },
  { name: 'Portfolio', href: '/portfolio' },
  { name: 'Lists', href: '/lists' },
  { name: 'Links', href: '/links' },
  { name: 'Subscribe', href: '/subscribe' }
]
---

<header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
  <div class="container flex h-16 items-center">
    <!-- Logo/Brand -->
    <div class="mr-4 hidden md:flex">
      <a class="mr-6 flex items-center space-x-2 font-bold text-xl" href="/">
        Gökhan Turhan
      </a>
    </div>
    
    <!-- Mobile Logo -->
    <div class="mr-4 flex md:hidden">
      <a class="mr-6 flex items-center space-x-2 font-bold text-lg" href="/">
        Gökhan Turhan
      </a>
    </div>

    <!-- Desktop Navigation - Centered -->
    <div class="flex-1 flex justify-center">
      <nav class="flex items-center space-x-8 text-sm font-medium hidden md:flex">
        {navigation.map((item) => (
          <a
            href={item.href}
            class={`transition-colors hover:text-foreground/80 ${
              currentPath === item.href 
                ? 'text-foreground font-medium' 
                : 'text-foreground/60'
            }`}
          >
            {item.name}
          </a>
        ))}
      </nav>
    </div>

    <!-- Right side actions -->
    <div class="flex items-center space-x-2">
      <!-- Search Button -->
      <Button variant="ghost" size="sm" id="search-button" class="relative">
        <Search class="h-4 w-4" />
        <span class="sr-only">Search</span>
        <kbd class="pointer-events-none absolute -top-1 -right-1 hidden h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100 sm:flex">
          ⌘K
        </kbd>
      </Button>
      
      <!-- Theme Toggle -->
      <ThemeToggle />
      
      <!-- RSS Button -->
      <Button variant="ghost" size="sm" class="hidden md:inline-flex">
        <a href="/rss.xml" class="flex items-center space-x-2">
          <Rss class="h-4 w-4" />
          <span class="hidden sm:inline-block">RSS</span>
        </a>
      </Button>

      <!-- Mobile Menu Button -->
      <Button variant="ghost" size="sm" class="md:hidden" id="mobile-menu-button">
        <Menu class="h-4 w-4" id="menu-icon" />
        <X class="h-4 w-4 hidden" id="close-icon" />
        <span class="sr-only">Toggle menu</span>
      </Button>
    </div>
  </div>

  <!-- Mobile Navigation -->
  <div class="md:hidden hidden" id="mobile-menu">
    <nav class="flex flex-col space-y-3 px-4 pb-4 pt-2">
      {navigation.map((item) => (
        <a
          href={item.href}
          class={`block px-3 py-2 text-base font-medium transition-colors hover:text-foreground/80 ${
            currentPath === item.href 
              ? 'text-foreground bg-accent rounded-md' 
              : 'text-foreground/60'
          }`}
        >
          {item.name}
        </a>
      ))}
      <button 
        id="mobile-search-button"
        class="flex items-center space-x-2 px-3 py-2 text-base font-medium text-foreground/60 hover:text-foreground/80"
      >
        <Search class="h-4 w-4" />
        <span>Search</span>
      </button>
      <a 
        href="/rss.xml" 
        class="flex items-center space-x-2 px-3 py-2 text-base font-medium text-foreground/60 hover:text-foreground/80"
      >
        <Rss class="h-4 w-4" />
        <span>RSS Feed</span>
      </a>
    </nav>
  </div>
</header>

<!-- Search Modal -->
<SearchComponent />

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const button = document.getElementById('mobile-menu-button')
    const menu = document.getElementById('mobile-menu')
    const menuIcon = document.getElementById('menu-icon')
    const closeIcon = document.getElementById('close-icon')

    button?.addEventListener('click', () => {
      const isHidden = menu?.classList.contains('hidden')
      
      if (isHidden) {
        menu?.classList.remove('hidden')
        menuIcon?.classList.add('hidden')
        closeIcon?.classList.remove('hidden')
      } else {
        menu?.classList.add('hidden')
        menuIcon?.classList.remove('hidden')
        closeIcon?.classList.add('hidden')
      }
    })

  })
</script>